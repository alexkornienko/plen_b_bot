require("dotenv").config();
const TelegramBot = require("node-telegram-bot-api");
const cron = require("node-cron");

const bot = new TelegramBot(process.env.BOT_TOKEN, { polling: true });

// –õ–æ–≥–∏–∫–∞, –µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ –ø–∏—à–µ—Ç /start (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
bot.onText(/\/start/, (msg) => {
  bot.sendMessage(
    msg.chat.id,
    "–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –ú–µ–Ω—è –∑–æ–≤—É—Ç –ì–µ–Ω–Ω–∞–¥–∏–π –ù–∞–ø–æ–º–∏–Ω–∞–ª–æ–≤. –Ø –±—É–¥—É –Ω–∞–ø–æ–º–∏–Ω–∞—Ç—å –æ —Ä–µ–ø–µ—Ç–∏—Ü–∏–∏ —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é. –ü–æ–∫–∞ —è —É–º–µ—é —Ç–æ–ª—å–∫–æ —ç—Ç–æ, –Ω–æ, –µ—Å–ª–∏ –°–∞—à–∫–µ –±—É–¥–µ—Ç –Ω–µ –ª–µ–Ω—å, –æ–Ω –ø–æ–¥ –ø–∏–≤–æ –¥–æ–±–∞–≤–∏—Ç —á—Ç–æ-–Ω–∏–±—É–¥—å –µ—â—ë"
  );
});

bot.onText(/\/help/, (msg) => {
  const helpMessage = `
–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
/start - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
/help - –°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥
/next - –£–∑–Ω–∞—Ç—å –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è —Å–ª–µ–¥—É—é—â–µ–π —Ä–µ–ø–µ—Ç–∏—Ü–∏–∏
  `;
  bot.sendMessage(msg.chat.id, helpMessage);
});

bot.onText(/\/next/, (msg) => {
  bot.sendMessage(
    msg.chat.id,
    "–°–ª–µ–¥—É—é—â–∞—è —Ä–µ–ø–µ—Ç–∏—Ü–∏—è ‚Äî –≤ —Å—É–±–±–æ—Ç—É –≤ 21:00. –ù–µ –∑–∞–±—É–¥—å—Ç–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å—Å—è!"
  );
});

// –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ (–∫–∞–∂–¥—É—é –ø—è—Ç–Ω–∏—Ü—É –≤ 09:05)
cron.schedule(
  "05 9 * * 5",
  () => {
    bot.sendMessage(
      process.env.CHAT_ID,
      "üìÖ –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ: –≤ —Å—É–±–±–æ—Ç—É —Ä–µ–ø–µ—Ç–∏—Ü–∏—è –≤ 21:00! –ï—Å–ª–∏ —É –∫–æ–≥–æ-—Ç–æ –ø–æ–º–µ–Ω—è–ª–∏—Å—å –ø–ª–∞–Ω—ã, —Å–æ–æ–±—â–∏—Ç–µ –æ–± —ç—Ç–æ–º"
    );
  },
  {
    timezone: "Europe/Moscow",
  }
);
